<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1"
        />
        <meta name="description" content="A cozy little corner of the web." />
        <title>
            A Tiny Introduction to Parsers Â· Isaac Clayton
        </title>
        <link rel="preload stylesheet" href="/fonts.css" as="style" />
        <link rel="stylesheet" href="/reset.css" />
        <link rel="stylesheet" href="/base.css" />
        <link rel="stylesheet" href="/layout.css" />
        <link rel="icon" type="image/png" href="/icon.png" />
        <link rel="alternate" type="application/atom+xml" href="https://slightknack.dev/atom.xml" />
        <script data-goatcounter="https://slightknack.goatcounter.com/count"
                async src="//gc.zgo.at/count.js"></script>
        <!-- <script async defer type="text/javascript"
        src="https://rawgit.com/patriciogonzalezvivo/glslCanvas/master/dist/GlslCanvas.js">
        </script> -->
        <!-- <script type="text/javascript" src="/elasticlunr.min.js" defer></script> -->
        <!-- <script type="text/javascript" src="/search_index.en.js" defer></script> -->
        <!-- <script type="text/javascript" src="/search.js" defer></script> -->

        <!-- maybe one day I'll bother to get these working... -->
        <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js"></script> -->
        <!-- <script type="module">
            import hotwiredTurbo from 'https://cdn.skypack.dev/@hotwired/turbo';
        </script> -->

         
    </head>

    <body style="overflow-x: hidden">
        
<!-- <div class="container"> -->
    <!-- <div class="sidebar">
    </div> -->
    <div class="content" id="top">
        <div class="narrow">
            <div class="navigation">
                <ul class="menu">
                      
                    <li class="pill">
                        <a class="tag" href="https:&#x2F;&#x2F;slightknack.dev&#x2F;about&#x2F;">
                             About 
                        </a>
                    </li>
                     
                    <li class="pill">
                        <a class="tag" href="https:&#x2F;&#x2F;slightknack.dev&#x2F;passerine&#x2F;">
                             Passerine 
                        </a>
                    </li>
                     
                    <li class="pill">
                        <a class="tag" href="https:&#x2F;&#x2F;slightknack.dev&#x2F;blog&#x2F;">
                             Blog 
                        </a>
                    </li>
                     
                    <li class="pill">
                        <a class="tag" href="https:&#x2F;&#x2F;slightknack.dev&#x2F;gallery&#x2F;">
                             Gallery 
                        </a>
                    </li>
                    
                    
<li class="pill">
    <a class="tag" href="https://goto.isaac.sh">Goto â†¬</a>
</li>
<li class="pill">
    <a class="tag" href="https://stats.isaac.sh">Stats â†¬</a>
</li>
<li class="pill">
    <a class="tag" href="https://git.isaac.sh">Github â†¬</a>
</li>
<li class="pill">
    <a class="tag" href="https://slightknack.dev/atom.xml">RSS â†¬</a>
</li>

                </ul>

                <div>

<a href="..">
    <div class="artbit">
        <img class="pixel-sidebar" src="/hypercard-artbits/4_framea.png" alt="Jump back up a level"/>
    </div>
</a>

</div>
            </div>

            <!-- <div class="text-input-container">
                <input
                    id="search"
                    type="search"
                    placeholder="Jump to..."
                    autocomplete="off"
                />
                <div class="search-results" style="display: none">
                    <div class="search-results__items"></div>
                </div>
            </div> -->

            
<!-- <div> -->
<h1 class="title" style="margin-top: 0;">A Tiny Introduction to Parsers</h1>
<p class="tag">2020-07-08 Â· About 3 minutes long</p>
<h1 id="a-question">A Question</h1>
<p>The other day, someone asked how parsers worked on The Programmerâ€™s Hangout Discord server. Hereâ€™s an an abridged version of my explanation.</p>
<span id="continue-reading"></span><h1 id="my-response">My Response</h1>
<p>A parser simply takes a stream of data and from it produces a datastructure. This stream is usually a stream of tokens, which are groups of tagged delimiters and data used to construct the datastructure.</p>
<p>Letâ€™s assume youâ€™re building a parser for a programming language; the parser converts a file to an abstract syntax tree. We start with a file; in this case, itâ€™s <em>AverageScript</em>:</p>
<pre data-lang="javascript" style="background-color:#151515;color:#e8e8d3;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#ffb964;">for i </span><span>in [</span><span style="color:#cf6a4c;">1</span><span>, </span><span style="color:#cf6a4c;">2</span><span>, </span><span style="color:#cf6a4c;">3</span><span>] {
</span><span>    </span><span style="color:#fad07a;">print</span><span>(</span><span style="color:#ffb964;">i</span><span>)
</span><span>}
</span></code></pre>
<p>And lex it into a series of tokens by walking over the file linearly. So, for instance:</p>
<pre style="background-color:#151515;color:#e8e8d3;"><code><span>for: keyword
</span><span>i:   identifier
</span><span>in:  keyword
</span><span>[:   delimiter
</span><span>1:   number
</span><span>,:   separator
</span><span>2:   number
</span><span>     ... snip ...
</span><span>}:   delimiter
</span></code></pre>
<p>This is the stream of tokens that will be fed into the parser to form the AST. So, how exactly does a parser work?</p>
<p>There are quite a few different kinds of parsers, but they all essentially reduce to the same set of steps:</p>
<ul>
<li>Look at the next few tokens to determine what is being parsed</li>
<li>For each sub-section of what is being parsed, repeat this process.</li>
<li>Using this information, build the datastructure.</li>
</ul>
<p>Most parsers are recursive for this reason; for example, in most languages, a function call can contain another function call:</p>
<pre data-lang="python" style="background-color:#151515;color:#e8e8d3;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#ffb964;">foo</span><span>(</span><span style="color:#ffb964;">bar</span><span>(</span><span style="color:#cf6a4c;">1</span><span>, </span><span style="color:#cf6a4c;">3</span><span>))
</span></code></pre>
<p>Instead of manually writing out cases for nesting, after we determine weâ€™re looking at a function, we simply parse the contents of <code>foo(...)</code> according to some pre-defined rule.</p>
<p>So returning to our original case: how might a parser parse the <code>for i in ...</code>?</p>
<p>Assuming some form of a recursive descent parser:</p>
<ol>
<li>The parser sees <code>for</code> and determines a for loop is being parsed; In this made-up language, a for loop has three components, an identifier, an iterator, and a body.</li>
<li>It takes the next token, <code>i</code> and checks that itâ€™s an identifier.</li>
<li>It takes the next token, <code>in</code> and makes sure itâ€™s the in keyword.</li>
<li>It recursively evaluates the next series of tokens as an expression
<ol>
<li>It sees <code>[</code> so it starts parsing as a list</li>
<li>It sees <code>2</code> and adds it to said list</li>
<li>And so on until the entire list is parsed</li>
</ol>
</li>
<li>It checks for <code>{</code> delimiting a for body</li>
<li>It recursively parses the next few tokens as a block of code
<ol>
<li>and so on until the entire code block is parsed</li>
</ol>
</li>
<li>It checks for <code>}</code>, ending the for loop</li>
<li>It constructs a for node and returns it.</li>
</ol>
<p>The end of this process might result in an AST that looks like so:</p>
<pre data-lang="rust" style="background-color:#151515;color:#e8e8d3;" class="language-rust "><code class="language-rust" data-lang="rust"><span>For {
</span><span>    identifier: i,
</span><span>    expression: List {
</span><span>        items: [</span><span style="color:#cf6a4c;">1</span><span>, </span><span style="color:#cf6a4c;">2</span><span>, </span><span style="color:#cf6a4c;">3</span><span>]
</span><span>    },
</span><span>    body: Code {
</span><span>        statements: [
</span><span>            Function {
</span><span>                identifier: print,
</span><span>                arguments: [i],
</span><span>            },
</span><span>        ],
</span><span>    },
</span><span>}
</span></code></pre>
<p>This AST can then be walked, interpreted, compiled, etc. There exist common formats to describe parsers; one such format is Extended Backus-Naur Form. Many parsing techniques exist; what I described models a LL(1) parser. Many parsing models exist; to learn more about them, I recommend you check the Parsing Wikipedia page.</p>
<p>So, to summarize:</p>
<ul>
<li>A parser takes a stream of data and builds a data-structure</li>
<li>Parsers generally work in a recursive manner by defining a set of rules that can be efficiently transversed.</li>
<li>Parsers can be formally described.</li>
<li>Many different parsing methods exist.</li>
</ul>
<p>I hope this helped clear some things up ðŸ™‚.</p>

<!-- </div> -->

        </div>
        <div class="narrow-unpadded">
            <p class="tag" style="text-wrap: balance;">
                Padded so you can keep scrolling. I know. I love you.
                How about we take you <a href="#top">back up to the top of this page</a>?
            </p>
        </div>
    </div>
<!-- </div> -->

    </body>
</html>
